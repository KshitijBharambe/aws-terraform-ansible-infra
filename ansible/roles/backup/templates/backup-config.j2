# Backup Configuration File
# Generated by Ansible for {{ ansible_hostname }}
# Environment: {{ ansible_environment }}
# Generated: {{ ansible_date_time }}

# Global backup settings
BACKUP_DIR="{{ backup_directory | default('/opt/backups') }}"
LOG_FILE="{{ backup_log_file | default('/var/log/backup.log') }}"
S3_BUCKET="{{ backup_s3_bucket | default('') }}"
RETENTION_DAYS={{ backup_retention_days | default('30') }}
COMPRESSION="{{ backup_compression | default('gzip') }}"
ENCRYPTION="{{ backup_encryption | default('true') }}"

# Backup schedules (cron format)
FULL_BACKUP_SCHEDULE="{{ backup_full_schedule | default('0 2 * * 0') }}"  # Sunday 2 AM
INCREMENTAL_BACKUP_SCHEDULE="{{ backup_incremental_schedule | default('0 3 * * 1-6') }}"  # Mon-Sat 3 AM

# Database backup settings
DB_BACKUP_ENABLED="{{ backup_db_enabled | default('true') }}"
DB_HOST="{{ backup_db_host | default('localhost') }}"
DB_USER="{{ backup_db_user | default('backup') }}"
DB_NAME="{{ backup_db_name | default('application') }}"
DB_BACKUP_DIR="${BACKUP_DIR}/database"

# Application backup settings
APP_BACKUP_ENABLED="{{ backup_app_enabled | default('true') }}"
APP_DIR="{{ backup_app_dir | default('/var/www/html') }}"
APP_BACKUP_DIR="${BACKUP_DIR}/application"

# System backup settings
SYSTEM_BACKUP_ENABLED="{{ backup_system_enabled | default('false') }}"
SYSTEM_CONFIG_DIR="{{ backup_system_config_dir | default('/etc') }}"
SYSTEM_BACKUP_DIR="${BACKUP_DIR}/system"

# Log backup settings
LOG_BACKUP_ENABLED="{{ backup_log_enabled | default('true') }}"
LOG_DIRS="{{ backup_log_dirs | default(['/var/log', '/var/log/nginx', '/var/log/httpd']) }}"
LOG_BACKUP_DIR="${BACKUP_DIR}/logs"

# Configuration backup settings
CONFIG_BACKUP_ENABLED="{{ backup_config_enabled | default('true') }}"
CONFIG_DIRS="{{ backup_config_dirs | default(['/etc/nginx', '/etc/httpd', '/etc/ssh', '/etc/fail2ban']) }}"
CONFIG_BACKUP_DIR="${BACKUP_DIR}/config"

# S3 backup settings
S3_ENABLED="{{ backup_s3_enabled | default('false') }}"
S3_REGION="{{ backup_s3_region | default('us-east-1') }}"
S3_ENDPOINT="{{ backup_s3_endpoint | default('') }}"
S3_STORAGE_CLASS="{{ backup_s3_storage_class | default('STANDARD') }}"

# Email notification settings
EMAIL_ENABLED="{{ backup_email_enabled | default('true') }}"
EMAIL_TO="{{ backup_email_to | default('admin@' + ansible_domain) }}"
EMAIL_FROM="{{ backup_email_from | default('backup@' + ansible_domain) }}"
SMTP_SERVER="{{ backup_smtp_server | default('localhost') }}"
SMTP_PORT="{{ backup_smtp_port | default('587') }}"

# Performance settings
PARALLEL_JOBS="{{ backup_parallel_jobs | default('2') }}"
BANDWIDTH_LIMIT="{{ backup_bandwidth_limit | default('10m') }}"
IO_NICE="{{ backup_io_nice | default('7') }}"

# Security settings
BACKUP_USER="{{ backup_user | default('backup') }}"
BACKUP_GROUP="{{ backup_group | default('backup') }}"
BACKUP_PERMISSIONS="{{ backup_permissions | default('640') }}"
KEY_FILE="{{ backup_key_file | default('/etc/backup/key') }}"

# Exclusion patterns
EXCLUDE_PATTERNS="{{ backup_exclude_patterns | default(['*.tmp', '*.log', 'cache/*', 'node_modules/*', '.git/*']) }}"

# Verification settings
VERIFY_ENABLED="{{ backup_verify_enabled | default('true') }}"
VERIFY_SAMPLE_SIZE="{{ backup_verify_sample_size | default('10') }}"

# Cleanup settings
CLEANUP_ENABLED="{{ backup_cleanup_enabled | default('true') }}"
CLEANUP_AFTER_DAYS="{{ backup_cleanup_after_days | default('7') }}"

# Script paths
BACKUP_SCRIPTS_DIR="/usr/local/bin/backup-scripts"
MONITORING_SCRIPT="/usr/local/bin/backup-monitor.sh"
REPORT_SCRIPT="/usr/local/bin/backup-report.sh"
CLEANUP_SCRIPT="/usr/local/bin/backup-cleanup.sh"
